# Обзор модели StockPredictor3

## Архитектура модели
Модель представляет собой LSTM-сеть с 2 слоями и 128 скрытыми нейронами. Архитектура включает:
- LSTM слой с 10 входными признаками, 128 скрытыми состояниями и 2 слоями
- Dropout 0.4 для регуляризации
- Линейный выходной слой
- Всего 203,905 параметров

## Используемые фичи (10 признаков)
1. [`Close`](stock_predictor/stock_predictor3.py:43) - цена закрытия
2. [`Volume`](stock_predictor/stock_predictor3.py:43) - объем торгов
3. [`Returns`](stock_predictor/stock_predictor3.py:27) - процентное изменение цены
4. [`EMA_10`](stock_predictor/stock_predictor3.py:28) - экспоненциальное скользящее среднее за 10 дней
5. [`EMA_50`](stock_predictor/stock_predictor3.py:29) - экспоненциальное скользящее среднее за 50 дней
6. [`Volatility`](stock_predictor/stock_predictor3.py:30) - волатильность (стандартное отклонение за 20 дней)
7. [`Volume_EMA`](stock_predictor/stock_predictor3.py:31) - EMA объема
8. [`RSI`](stock_predictor/stock_predictor3.py:34) - индекс относительной силы
9. [`MACD`](stock_predictor/stock_predictor3.py:35) - схождение/расхождение скользящих средних
10. [`Price_Range`](stock_predictor/stock_predictor3.py:38) - отношение (High-Low)/Close

## Результаты модели

### Метрики качества:
- MSE: $10.38
- MAE: $2.29
- MAPE: 0.98%
- Directional Accuracy: 52.0% (точность предсказания направления изменения цены)
- Точность для роста: 59.2%
- Точность для падения: 42.6%

### Данные:
- Обучающая выборка: 804 даты (70%)
- Валидационная выборка: 124 даты (15%)
- Тестовая выборка: 125 дат (15%)
- Период данных: 2020-12-24 - 2025-11-25
- Длина последовательности: 60 дней

### Особенности:
- Используется сбалансированная функция потерь (BalancedLoss) с штрафом за смещение
- Ранняя остановка с параметром patience=25
- Обучение остановлено на 34-й эпохе, восстановлены веса с 9-й эпохи
- Модель склонна занижать предсказания (средняя ошибка - $0.54)
- 56.8% предсказаний занижены

Модель показывает умеренную точность в предсказании направления изменения цен (52%), что немного выше случайного уровня (50%), но все еще требует улучшения для практического использования.
